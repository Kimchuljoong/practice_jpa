# Practice JPA for remind

### 영속성 컨텍스트의 변경 내용 데이터베이스에 반영 방법(플러시)
1) 직접호출 : em.flush()  
2) 트랜잭션 커밋 시 자동호출  
3) JPQL 쿼리 실행 시 자동호출  
* 플러시모드  
FlushModeType.AUTO : 커밋이나 쿼리를 실행할 때 플러시(기본값)  
FlushModeType.COMMIT : 커밋할 때만 플러시  

플러시는 영속성 컨텍스트에 보관된 엔티티를 지우는게 아니고 영속성 컨텍스트의 변경 내용을 데이터베이스에 동기화 하는 것  
  
### 준영속 상태
영속성 컨텍스트의 관리를 벗어난 상태
  
1. detach() : 특정 엔티티에 대해서 준영속 상태로 만듬  
2. clear() : 해당 영속성 컨텍스트의 모든 엔티티를 준영속 상태로 만듬  
3. close() : 영속성 컨텍스트를 종료하는 것으로 영속성 컨텍스트가 종료되면 해당 영속성 컨텍스트가 관리하던 엔티티들이 전부 준영속 상태가 됨  

### 병합(Merge)
준영속 상태의 엔티티를 다시 영속 상태로 만듬

1) merge() : em.merge(member) 로 사용, 1차 캐시에서 엔티티를 찾고 없는 경우 DB조회  
있는 경우 조회 후 1차 캐시, 영속상태 후 반환  
없는 경우 새로운 엔티티를 생성해서 병합 (비영속 병합, INSERT or UPDATE 기능 수행)  

